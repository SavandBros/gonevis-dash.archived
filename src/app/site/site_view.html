<!-- Site cover image -->
<div class="container-fluid container-image" ng-if="site.media.cover_image" ng-click="selectImage('cover_image')"
  style="background-image: url('{{ site.media.cover_image.file }}')">
  <p><i class="fa fa-fw fa-edit"></i> {{ 'CHANGE_COVER_IMAGE' | translate }}</p>
</div>

<!-- Restricted page -->
<restricted-page ng-if="isRestrict"></restricted-page>

<!-- Main -->
<div class="container container-light animated fadeIn" ng-if="!isRestrict">

  <!-- Left panels -->
  <div class="col-md-8">

    <!-- Settings -->
    <div class="panel panel-default">
      <h4 class="panel-heading lower">
        <!-- Logo -->
        <img class="img-circle heading-image" ng-if="site.media.logo" ng-src="{{ site.media.logo.thumbnail_48x48 }}">
        <!-- Title -->
        <span style="line-height: 40px">{{ site.title }}</span>
        <!-- Visit -->
        <a class="btn btn-default pull-right"
          ng-href="{{ site.absolute_uri }}" target="_blank" title="{{ 'GO_TO_SITE' | translate }}">
          {{ 'VIEW_SITE' | translate }}
        </a>
        <div class="clearfix"></div>
      </h4>
      <div class="panel-body s-pad">
        <!-- Title -->
        <div class="input-panel">
          <div class="row">
            <div class="col-xs-3 col-sm-2"><small class="t-upp" translate>TITLE</small></div>
            <div class="col-xs-9 col-sm-10">
              <span editable-text="site.title" onbeforesave="updateSite('title', $data)">
                {{ site.title || "NOTHING_HERE" | translate }}
              </span>
            </div>
          </div>
        </div>
        <!-- URL -->
        <div class="input-panel">
          <div class="row">
            <div class="col-xs-3 col-sm-2"><small translate>URL</small></div>
            <div class="col-xs-9 col-sm-10 t-line">
              <a ng-href="{{ site.absolute_uri }}" target="_blank" title="{{ 'CANT_CHANGE' }}">
                {{ site.absolute_uri || "NOTHING_HERE" | translate }}
              </a>
            </div>
          </div>
        </div>
        <!-- Description -->
        <div class="input-panel">
          <div class="row">
            <div class="col-xs-12 col-sm-2"><small class="t-upp" translate>DESCRIPTION</small></div>
            <div class="col-xs-9 col-sm-10">
              <span editable-textarea="site.description" onbeforesave="updateSite('description', $data)">
                {{ site.description || "NOTHING_HERE" | translate }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Advanced -->
    <div class="panel panel-default">
      <div class="panel-heading lower" translate>ADVANCED</div>
      <div class="panel-body s-pad">
        <!-- Meta Description -->
        <div class="input-panel">
          <div class="row">
            <div class="col-sm-3"><small class="t-upp" translate>META_DESCRIPTION</small></div>
            <div class="col-sm-9">
              <span editable-textarea="site.meta_description" e-maxlength="160"
                onbeforesave="updateSite('meta_description', $data)">
                {{ site.meta_description || "NOTHING_HERE" | translate }}
              </span>
            </div>
          </div>
        </div>
        <!-- Post Per Page -->
        <div class="input-panel">
          <div class="row">
            <div class="col-xs-8 col-sm-9">
              <small style="margin-top: 10px" class="dis-b" translate>NUMBER_OF_POSTS_PP</small>
            </div>
            <div class="col-xs-4 col-sm-3">
              <select class="form-control" ng-model="site.paginate_by"
                ng-change="updateSite('paginate_by', site.paginate_by)">
                <option ng-value="$index" ng-if="$index" ng-repeat="number in postPerPage track by $index">
                  {{ $index }}
                </option>
              </select>
            </div>
          </div>
        </div>
        <!-- Commenting -->
        <div class="s-mar-y">
          <div class="checkbox checkbox-primary checkbox-small">
            <input id="commenting" type="checkbox" ng-model="site.commenting"
              ng-change="updateSite('commenting', site.commenting)">
            <label for="commenting" translate>ALLOW_VISITORS_TO_COMMENT</label>
          </div>
        </div>
        <!-- Voting -->
        <div class="s-mar-y">
          <div class="checkbox checkbox-primary checkbox-small">
            <input id="voting" type="checkbox" ng-change="updateSite('voting', site.voting)" ng-model="site.voting">
            <label for="voting" translate>ALLOW_VISITORS_TO_VOTE</label>
          </div>
        </div>
        <!-- Search engine visibility -->
        <div class="s-mar-top">
          <div class="checkbox checkbox-primary checkbox-small">
            <input id="search_engine_visibility" type="checkbox"
              ng-change="updateSite('search_engine_visibility', site.search_engine_visibility)"
              ng-model="site.search_engine_visibility">
            <label for="search_engine_visibility" translate>SEARCH_ENGINE_DISCOVER</label>
          </div>
        </div>
        <!-- Branding -->
        <div class="s-mar-top">
          <div class="checkbox checkbox-primary checkbox-small"
            title="{{ 'REMOVE_BRANDING_TITLE' | translate }}">
            <input id="remove_branding" type="checkbox"
              ng-change="updateSite('remove_branding', site.remove_branding)"
              ng-model="site.remove_branding">
            <label for="remove_branding" translate>REMOVE_BRANDING</label>
          </div>
        </div>
        <!-- Footer text -->
        <div class="input-panel s-mar-top" ng-if="site.remove_branding">
          <div class="row">
            <div class="col-sm-3"><small class="t-upp" translate>FOOTER_TEXT</small></div>
            <div class="col-sm-9">
              <span editable-textarea="site.footer_text" e-maxlength="500"
                onbeforesave="updateSite('footer_text', $data)">
                {{ site.footer_text || "NOTHING_HERE" | translate }}
              </span>
            </div>
          </div>
        </div>
        <!-- Allow Google Analytics -->
        <div class="s-mar-top">
          <div class="checkbox checkbox-primary checkbox-small"
            title="{{ 'ALLOW_GOOGLE_ANALYTICS_TITLE' | translate }}">
            <input id="google_analytics_enabled" type="checkbox"
              ng-change="updateSite('google_analytics_enabled', site.google_analytics_enabled)"
              ng-model="site.google_analytics_enabled">
            <label for="google_analytics_enabled" translate>ALLOW_GOOGLE_ANALYTICS</label>
          </div>
        </div>
        <!-- Google Analytics code -->
        <div class="input-panel s-mar-top" ng-if="site.google_analytics_enabled">
          <div class="row">
            <div class="col-xs-8 col-sm-9"><small class="t-upp" translate>GOOGLE_ANALYTICS_CODE</small></div>
            <div class="col-xs-4 col-sm-3">
              <span editable-text="site.google_analytics_code" e-maxlength="100"
                onaftersave="updateSite('google_analytics_code', $data)">
                {{ site.google_analytics_code || "NOTHING_HERE" | translate }}
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="panel-footer" ng-if="!hideDelete">
        <!-- Delete -->
        <button class="btn btn-danger" ng-click="deleteSite()">
          <i class="fa fa-fw fa-trash"></i> {{ 'DELETE_SITE' | translate }}
        </button>
      </div>
    </div>

    <!-- Custom domains -->
    <div class="panel panel-default">
      <div class="panel-heading lower" translate>DOMAINS</div>
      <div class="panel-body">
        <!-- Help text -->
        <p>
          <i class="fa fa-info-circle"></i>
          <translate>DOMAINS_HELP_TEXT</translate>
        </p>
        <hr>
        <!-- Domain list -->
        <table class="table table-hover" ng-if="site.domains.length">
          <thead>
            <tr>
              <th translate>DOMAIN_NAME</th>
              <th translate>DNS_TARGET</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="domain in site.domains">
              <!-- Domain link -->
              <td><a ng-href="https://{{ domain.domain }}" target="_blank">{{ domain.domain }}</a></td>
              <!-- Domain DNS Target -->
              <td>{{ domain.cname }}</td>
              <!-- Remove button -->
              <td>
                <button class="btn btn-xs btn-default pull-right o-fade-hard o-fade-hover-full"
                  title="{{ 'DELETE_THIS_DOMAIN' | translate }}" ng-click="deleteDomain(domain)">
                  <i class="fa fa-close"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
        <!-- Add domain -->
        <button class="btn btn-default" ng-click="addDomain()"
          ng-disabled="site.domains.length == maxCustomDomains" translate>ADD_DOMAIN</button>
      </div>
    </div>
  </div>

  <!-- Right panels -->
  <div class="col-md-4 animated fadeIn" ng-if="siteTemplate">

    <!-- Appearance -->
    <form class="panel panel-default">
      <h3 class="panel-heading lower" style="line-height: 40px" translate>APPEARANCE</h3>
      <div class="panel-body">
        <!-- Template -->
        <button class="btn btn-primary btn-block btn-lg" ng-click="siteTemplates()" ng-disabled="loadingTemplate">
          <small translate>THEME_DD</small> {{ siteTemplate.name | uppercase }}
        </button>
        <br>
        <!-- Site images -->
        <div class="btn-group stack stack-equal">
          <button class="btn btn-default" ng-click="selectImage('logo')"
            title="{{ 'SITE_LOGO_TITLE' | translate }}" translate>
            SITE_LOGO
          </button>
          <button class="btn btn-default" ng-click="selectImage('cover_image')"
            title="{{ 'SITE_COVER_TITLE' | translate }}" translate>
            SITE_COVER
          </button>
        </div>
        <!-- Theme options -->
        <span ng-if="siteTemplate.hasFields">
          <!-- Label -->
          <p class="s-mar-y"><i class="fa fa-cog"></i> <b translate>THEME_OPTIONS</b></p>
          <!-- Template fields -->
          <div class="form-group" ng-repeat="(key, field) in siteTemplate.fields"
            ng-class="{'checkbox checkbox-primary': field.type === 'boolean'}">
            <hr ng-if="!$first">
            <!-- Char and boolean field -->
            <input id="{{ key }}" name="{{ key }}" type="{{ field.type === 'char' ? 'text' : 'checkbox' }}"
              class="form-control" ng-if="field.type !== 'text'" placeholder="{{ field.verbose_name }}"
              ng-model="siteTemplate.fields[key].value">
            <!-- Field label -->
            <label for="{{ key }}"><b>{{ field.verbose_name }}</b></label>
            <!-- Text field -->
            <textarea name="{{ key }}" type="text" class="form-control" ng-if="field.type === 'text'"
              placeholder="{{ field.verbose_name }}" ng-model="siteTemplate.fields[key].value">
            </textarea>
            <span class="help-block" style="margin-left: 20px">{{ field.help_text }}</span>
          </div>
          <br>
          <!-- Update button -->
          <button class="btn btn-default btn-block" ng-click="saveConfig()" ng-disabled="loadingTemplate">
            <i class="fa fa-fw fa-check text-primary"></i> {{ 'SAVE_CHANGES' | translate }}
          </button>
        </span>
      </div>
    </form>

    <!-- Debug -->
    <div class="panel panel-danger">
      <div class="panel-body">
        <button class="btn btn-danger btn-block" ng-click="subscribe()">Subscribe</button>
      </div>
    </div>
  </div>
</div>
